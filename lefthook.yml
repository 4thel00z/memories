pre-commit:
  parallel: true
  commands:
    fmt:
      glob: "*.go"
      run: gofmt -l -w {staged_files}
      stage_fixed: true
    vet:
      glob: "*.go"
      run: go vet ./...
    lint:
      glob: "*.go"
      run: golangci-lint run --new-from-rev=HEAD~1
    test:
      glob: "*.go"
      run: go test -short ./...

commit-msg:
  commands:
    conventional:
      run: |
        msg=$(cat {1})
        if ! echo "$msg" | grep -qE "^(feat|fix|docs|style|refactor|test|chore|build|ci|perf|revert)(\(.+\))?: .+"; then
          echo "Commit message must follow conventional commits format"
          echo "Examples: feat: add feature, fix(scope): bug fix"
          exit 1
        fi
